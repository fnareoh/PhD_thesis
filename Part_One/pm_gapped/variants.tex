\section{Gapped and Top-\texorpdfstring{$k$}{k} Consecutive Pattern Matching}
We now explain how to modify the algorithm to report only the co-occurrences with a bounded gap (Corollary~\ref{cor:ab}) and only the top-$k$ co-occurrences in the text (Corollary~\ref{cor:topk}).

\paragraph*{Bounded-gap co-occurrences.} We run the algorithm of Section~\ref{pmgapped:sec:consec} in $O(g+m)$ time to generate a description of all primary co-occurrences (the elements of this description are single co-occurrences and arithmetic progressions of co-occurrences with a fixed gap) and select the elements of this description with a gap in $[a,b]$. For each selected element, we apply the approach of~\cite[Section 6.4]{talg/ChristiansenEKN21}) to generate all co-occurrences with a gap in the interval $[a,b]$ in time $O(g+m+\occ)$. 

\paragraph*{Top-$k$ co-occurrences.}
To report the top-$k$ co-occurrences, we first generate a description of all primary co-occurrences (the elements of this description are single co-occurrences and arithmetic progressions of co-occurrences with a fixed gap) in $O(g+m)$ time as in Section~\ref{pmgapped:sec:consec}. Second,  we arrange the elements of the description in a heap in $O(g)$ time sorted by the gaps. Then, conceptually, we attach to each node of the heap a path containing the secondary co-occurrences that originate from the element stored in the node. We finally select the $k$ co-occurrences with smallest gaps in $O(k)$ time using Frederickson's heap selection algorithm~\cite{FREDERICKSON1993197}. The algorithm and its analysis requires the min-heap property, the fact that all nodes have constant degree, and to have quick access to the children of an already visited node. The first two properties are guaranteed by construction, and the method of~\cite[Section 6.4]{talg/ChristiansenEKN21}) guarantees that the children of an already visited node can be accessed in constant amortised time.


\newcommand{\Run}[5]{% start_x, start_y, width_period, heigth_period, nb_rep
%command to draw a run of full periods
\node (s1) at (#1,#2) {};% start of the run
\foreach \y in {1,...,#5} \draw ($(s1)+(\y*#3*2,0.5)$) arc(0:180:#3 and #4);
}


\newcommand{\Initshift}{
%rectangle
\node (a) at (-1,-0.5) {};
\node (b) at (14,-0.5) {};
\draw[gray] (a) -- (b);
\draw[gray] (7,-0.7) -- (7,-0.3);

%C1
\node(c1) at (0,0) {};
\node at ($(c1)+(0,1.5)$) {$C_1$};
%\draw (c1) rectangle ($(c1)+(3,0.5)$);
\Run{0}{0.1}{0.5}{0.5}{5}
\draw (5.6,1.1) arc(90:180:0.6 and 0.5);

%C2
\node (c2) at (9,0) {};
\node at ($(c2)+(4,1.25)$) {$C_2$};
\Run{8.5}{0.1}{0.25}{0.25}{8}
\draw (8.2,0.9) arc(90:0:0.3 and 0.2);

}

\begin{figure}
\centering
\captionsetup[subfigure]{justification=centering}

\begin{subfigure}{\textwidth}
\centering
\begin{tikzpicture}[scale=0.8, every node/.style={scale=1}]
\Initshift
%a1
\node (a1) at ($(c1)+(1,0)$) {};
\draw[fill=color1] ($(a1)$) rectangle ++(2.2,0.5) node [midway] {$a_1$};
\draw ($(a1)+(0,0.25)$) -- ($(a1)+(-0.4,0.25)$)node [midway,yshift=-0.3cm, xshift=-0.1cm] {$x_1$};
\draw ($(a1)+(2.2,0.25)$) -- ($(a1)+(3.2,0.25)$)node [midway,yshift=-0.3cm] {$y_1$};

%a2
\node (a2) at ($(c2)+(2,0)$) {};
\draw[fill=color2] ($(a2)$) rectangle ($(a2)+(1,0.5)$) node [midway] {$a_2$};
\draw ($(a2)+(0,0.25)$) -- ($(a2)+(-1.4,0.25)$)node [midway,yshift=-0.3cm] {$x_2$};
\draw ($(a2)+(1,0.25)$) -- ($(a2)+(1.4,0.25)$)node [midway,yshift=-0.3cm,xshift=0.1cm] {$y_2$};
\end{tikzpicture}
\caption{Leftmost occ for $P_1$ and righmost occ for $P_2$}
\label{fig:periodic:shift:notshifted}
\end{subfigure}

\begin{subfigure}{\textwidth}
\centering
\begin{tikzpicture}[scale=0.8, every node/.style={scale=1}]
\Initshift
%a1
\node (a1) at ($(c1)+(2,0)$) {};
\draw[->] ($(a1)+(-1,1.25)$) -- ($(a1)+(0,1.25)$)node [midway,yshift=0.3cm,xshift=0.5cm] {\small{$shift_1=1$}};
\draw[fill=color1] ($(a1)$) rectangle ++(2.2,0.5) node [midway] {$a_1$};
\draw ($(a1)+(0,0.25)$) -- ($(a1)+(-0.4,0.25)$)node [midway,yshift=-0.3cm, xshift=-0.1cm] {$x_1$};
\draw ($(a1)+(2.2,0.25)$) -- ($(a1)+(3.2,0.25)$)node [midway,yshift=-0.3cm] {$y_1$};

%a2
\node (a2) at ($(c2)+(1,0)$) {};
\draw[->] ($(a2)+(2,1)$) -- ($(a2)+(1,1)$)node [midway,yshift=0.3cm,xshift=-0.5cm] {\small{$shift_2=2$}};
\draw[fill=color2] ($(a2)$) rectangle ($(a2)+(1,0.5)$) node [midway] {$a_2$};
\draw ($(a2)+(0,0.25)$) -- ($(a2)+(-1.4,0.25)$)node [midway,yshift=-0.3cm] {$x_2$};
\draw ($(a2)+(1,0.25)$) -- ($(a2)+(1.4,0.25)$)node [midway,yshift=-0.3cm,xshift=0.1cm] {$y_2$};
\end{tikzpicture}
\caption{Rightmost occ for $P_1$ and leftmost occ for $P_2$}
\label{fig:periodic:shift:shifted}
\end{subfigure}


\caption{Illustration of the $shift_1$ and $shift_2$ definitions for periodic patterns $P_1$ and $P_2$ with extension $x_1,y_1$ and $x_2,y_2$ respectfully.}\label{fig:periodic-shift}
\end{figure}
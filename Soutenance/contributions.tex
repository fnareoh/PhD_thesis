
\begin{frame}[noframenumbering,plain]
    \mytitle{Contributions}
    \vspace{1cm}

    \includegraphics[width=\textwidth]{pictures/mindmap/co_auth.png}
\end{frame}

\begin{frame}[noframenumbering,plain]
    \only<1|handout:0>{\includegraphics[width=\textwidth]{pictures/mindmap/3.png}}
    \only<2|handout:0>{\includegraphics[width=\textwidth]{pictures/mindmap/4.png}}
    \only<3|handout:0>{\includegraphics[width=\textwidth]{pictures/mindmap/5.png}}
    \only<4>{\includegraphics[width=\textwidth]{pictures/mindmap/present.png}}
\end{frame}

\begin{frame}
    \includegraphics[width=\textwidth]{pictures/mindmap/regexp.png}
\end{frame}

\begin{frame}{A powerful matching model: regular expressions}
    \begin{columns}
        \column{.6\textwidth}
        \begin{mydefblock}{Regular expressions}
            either a character from $\Sigma$ or recursively defined from other regular expressions $R_1$ and $R_2$:
            \pause
            \begin{enumerate}
                \item $R_1 \cdot R_2$ (concatenation),
                \pause
                \item $R_1 | R_2$ (union),
                \pause
                \item $R_1^\ast$ (Kleene star).
            \end{enumerate}
            \pause
        \end{mydefblock}
        \column{.4\textwidth}
        \begin{center}
            \only<1|handout:0>{\textbf{Ex:} For $\Sigma=\{a,b\}$,\\ 
             $R_1=a$ only matches $a$,\\
             and $R_2=b$ only matches $b$.}
            \only<2|handout:0>{$R_1 \cdot R_2$ matches anything matching $R_1$ followed by anything matching $R_2$.\\
            \textbf{Ex:} with $R_1=a$ and $R_2=b$, $R_1 \cdot R_2$ matches $ab$.}
            \only<3|handout:0>{$R_1 | R_2$ matches anything matching $R_1$ or  $R_2$.\\
            \textbf{Ex:} with $R_1=a \cdot b = ab$ and $R_2=b$, $R_1 \cdot R_2$ matches $ab$ and $b$.}
            \only<4|handout:0>{$R_1^\ast$ matches any number of repetition of any string matching $R_1$.\\
            \textbf{Ex:} with $R_1=(b|ab)$ matches $\varepsilon$, $ab$, $b$, $bbabb$...}
            \only<5->{
                \textbf{Ex:} $b(b|ab)^\ast ab$\\
                \smallskip
                \cmark ~ $bbbbbabab$ \\
                \cmark ~ $bbbabbbbab$\\
                \xmark ~ $bbbaabbbab$\\
                \xmark ~ $baba$\\ 
                \xmark ~ $abab$\\
                }
        \end{center}
    \end{columns}    
    \pause
    \pause

    \bigskip
    \only<7->{Used in databases, \pause data mining, \pause secret detection,\pause computer networks, \pause protein search\pause ...\\}
    \pause
    \bigskip
    \only<12->{
        \beamermathcolor{myblue}
        Given a regular expression $R$ and a text $T$, two problems:\\
        \bblue{Membership:} check if $R$ matches $T$.\\
        \bblue{Pattern matching:} check if $R$ matches \textbf{some substring} of $T$. \pause \textcolor{myblue}{Reduces to membership!}
    }
\end{frame}

\begin{frame}{A frugal model of computation: streaming}
\begin{columns}
    \column{.4\textwidth}
    The algorithm first receives and preprocesses the expression.\\ Next, it keeps reading characters from a very very long text and:
    \column{.5\textwidth}
    \begin{center}
        \includegraphics[width=\textwidth]{pictures/stream3}
    \end{center}
\end{columns}

\smallskip
\pause
\begin{enumerate}
\item No delay: After having seen the $i$-th character, immediately report whether the string so far matches the regular expression.
\pause
\item No going back: Not possible to read any of the earlier characters.
\pause
\item Every space counts: No access to the original expression (unless stored explicitly).
\end{enumerate}
\pause
\begin{mylemblock}{Classic pattern matching in streaming [Breslauer and Galil, TALG'14]}
    For a pattern of length $m$, it takes $\Oh(\log m)$ space and $\Oh(1)$ time per position.
\end{mylemblock}\pause
\begin{center}
    \small
    It relies on a variant of the Karp--Rabin fingerprints introduced by \ntheme{[Porat and Porat, FOCS'09]}.
\end{center}
\end{frame}

\begin{frame}{What can we do for regular expression membership in streaming ?}
    \begin{columns}
        \column{.35\textwidth}
        \ntheme{Classic:} Recursively build the \btheme{Thompson automata}, then check if $T$ is accepted.\\
        $\Oh(m)$ space and time/character.
        \column{.5\textwidth}
        \centering
        \begin{picture}(200,65)
            \put(0,0){\includegraphics[width=\textwidth]{pictures/thomson1.png}}
            \put(150,50){\small $b(b|ab)^\ast ab$}
        \end{picture}
    \end{columns}
    \pause
    \begin{itemize}
        \item The best improvements on the time complexity \ntheme{only reduce by logarithmic factors}.\pause
        \item Fine-grained complexity showed that for \ntheme{``hard to match'' expressions we cannot do better}.\pause
        \item \ntheme{[Bille and Thorup, SODA'10]} Streaming time $\Oh(n\cdot (\frac{d\log w}{w}+\log d))$ and $\Oh(m)$ space, where $d$ is the number of occurrences of $|$ and $\ast$.\pause
        \item What about \btheme{space efficiency} ?\pause
    \end{itemize}
\end{frame}

\begin{frame}{What parameter is important for space-efficiency of regexp in Streaming ?}
    TODO: Dictionary and wildcards matching 

    \begin{myalertblock}{Dudek, Gawrychowski, Gourdel, Starikovskaya, SODA'22}
        For any regular expression $R$ with $d$ occurrences of $|$ and $\ast$, we can solve regular expression membership using $\Oh(d^{3}\polylog n)$ space and $\Oh(nd^{5}\polylog n)$ time per character.
    \end{myalertblock}
\end{frame}

\begin{frame}{}

    \begin{myalertblock}{Dudek, Gawrychowski, Gourdel, Starikovskaya, SODA'22}
        For any regular expression $R$ with $d$ occurrences of $|$ and $\ast$, we can solve regular expression membership using $\Oh(d^{3}\polylog n)$ space and $\Oh(nd^{5}\polylog n)$ time per character.
    \end{myalertblock}
    TODO: Intuition of how it works  
\end{frame}

\begin{frame}
    \includegraphics[width=\textwidth]{pictures/mindmap/dtw.png}
\end{frame}


\newcommand{\dtw}{\mathrm{DTW}}
\newcommand{\ed}{\mathrm{ED}}
\newcommand{\RLE}{\mathrm{RLE}}

\begin{frame}{Dynamic time warping (DTW) distance }

A \ntheme{measure of similarity between two temporal sequences} which can vary in speed.

\begin{center}
\includegraphics[scale=0.3]{figures/dtw_vs_euc.png}\footnote{Figure credit: Romain Tavenard}
\end{center}
\pause
Used in speech recognition to deal with varying speaking speeds.\pause

It has been studied for \ntheme{parametrized curves} where each item is a multidimensional point.

We focus on the setting where element are from a finite alphabet $\Sigma$, the sequences are \ntheme{strings}.

\end{frame}

\begin{frame}{Formal definition of $\dtw(X,Y)$ and dynamic programming}
\vspace{-1cm}
\begin{columns}
\column{0.5\textwidth}
\input{figures/grid_DTW}
\begin{figure}
    \beamermathcolor{black}
    \centering
    \begin{tikzpicture}[scale=0.8, every node/.style={scale=1.2}]
    \dtwgrid{5}{2}

    \foreach \i in {1,...,6} {
        \node at ($(\i-1, 2.8)$) {\tiny{$X[\i]$}};
    }
    \foreach \j in {1,...,3} {
        \node at ($(-1.2, 3 -\j )$) {\tiny{$Y[\j]$}};
    }

    \foreach \x[count=\i] in {C,A,A,A,G,G} {
        \node at ($(\i-1 , 2.3)$) {\textcolor{black}{\tiny{\x}}};
    }
    \foreach \y[count=\j] in {A,T,G} {
        \node at ($(-0.5, 3 -\j )$) {\textcolor{black}{\tiny{\y}}};
    }


    \only<2->{
        \dtwarrow{(0.1,2)}{(0.9,2)}
        \dtwarrow{(3.1,1.9)}{(3.9,1.1)}
        \dtwarrow{(1.1,2)}{(1.9,2)}
        \dtwarrow{(2.1,2)}{(2.9,2)}
        \dtwarrow{(4,0.9)}{(4,0.1)}
        \dtwarrow{(4.1,0)}{(4.9,0)}
        \node at (5,-0.3) {\bred{$\pi$}};
    }

    \end{tikzpicture}
\end{figure}
\column{0.4\textwidth}
\centering
\only<3>{
$\text{cost}(\pi) = \sum_{(i,\ j)\in \pi} d(X[i],Y[j])$\\
\vspace{0.5cm}
$\dtw(X,Y) = \min_{\pi} \text{cost}(\pi)$\\
\vspace{0.5cm}
{\small s.t. $\pi$ goes from top left to bottom right.}}
\end{columns}
\pause %grid definition 
\pause %draw the path
\pause

\bigskip


\only<4|handout:0>{
\begin{exampleblock}{Path correspondance to alignment}
\center
\begin{figure}
%\missingfigure{Under construction...}
\centering
\begin{tikzpicture}[scale=0.7, every node/.style={scale=1}]
\foreach \x[count=\i] in {C,A,A,A,G,G} {
    \node at ($(\i, 1)$) {\small{\x}};
}
\foreach \y[count=\j] in {A,T,G} {
    \node at ($(0.5+\j*1.5, 0)$) {\small{\y}};
}
% align A
\fill[myblue!25] (2, 0.25) -- (2,0.75) -- (4,0.75) -- (2.1,0.25) -- cycle;
% align G
\fill[myblue!25] (5, 0.25) -- (5,0.75) -- (6,0.75) -- (5.1,0.25) -- cycle;
%draw misalignment
\draw[dashed,red] (1.75, 0.25) -- (1,0.75);
\draw[dashed,red] (3.5, 0.25) -- (5,0.75);
\end{tikzpicture}
\end{figure}
\vfill
$\dtw($CAAAG$,$ATG$)=2$
\end{exampleblock}}

\only<5->{

\btheme{Dynamic Programming solution}\\
\smallskip
$D$ a matrix of size $(M+1)(N+1)$ such that $D[i,j]=\dtw(X[1..i],Y[1..j])$\pause
\bigskip

\begin{columns}
    \column{0.27\textwidth}
    \btheme{Initialization}\\
    \smallskip
    \small{
        $D[0,0]= 0$ and for all $(i,j)$, $D[0,j]=D[i,0]=+\infty$ \pause
        }
    \column{0.67\textwidth}
    \btheme{Recurrence}\\
    \smallskip
    \small{
    $D[i,j] = \min\{$\beamermathcolor{black}
        $\underbrace{\mathcolor{black!30!blue}{D[i-1,j-1]}}_\text{top-left},
        \underbrace{\mathcolor{black!30!blue}{D[i-1,j]}}_\text{top},
        \underbrace{\mathcolor{black!30!blue}{D[i,j-1]}}_\text{left}$
    $\mathcolor{black!30!blue}{\}+ d(X[i], Y[j])}$}
\end{columns}
}

\end{frame}


\begin{frame}{Comparison to the edit distance}
\beamermathcolor{black}
\[
D[i,j] = {\min\{
\underbrace{D[i-1,j-1]}_\text{top-left},
\underbrace{D[i-1,j]}_\text{top},
\underbrace{D[i,j-1]}_\text{left}
\} \mathcolor{red}{+ d(X[i], Y[j])}
}
    \]

\[
ED[i,j] = {\min\{
\underbrace{ED[i-1,j-1]}_\text{top-left} \mathcolor{red}{+ d(X[i], Y[j])},
\underbrace{ED[i-1,j]}_\text{top} \mathcolor{red}{+1},
\underbrace{ED[i,j-1]}_\text{left} \mathcolor{red}{+1}
\}
}
    \]

\pause

\begin{exampleblock}{DTW vs ED}
$\ed(AAAA\mathcolor{myblue}{T}G,AA\mathcolor{myblue}{T}C)=3$ whereas $\dtw(AAAA\mathcolor{myblue}{T}G,AA\mathcolor{myblue}{T}C)=1$.\\
$\dtw(AAAA\mathcolor{myblue}{T}G,AA\mathcolor{myblue}{T}CCC)=3$
\end{exampleblock} \pause
    
$\Rightarrow$ Compresses runs of matching letters!

\end{frame}

\begin{frame}{Where DTW may perform better: third generation sequencing}
    \begin{center}
    \includegraphics[scale=0.25]{figures/ont-sequencing_yourgenome.png}\footnote{Figure credit: \href{https://www.yourgenome.org/facts/what-is-oxford-nanopore-technology-ont-sequencing/}{yourgenome.org}}
    \end{center}
    
    Uneven speed of the DNA through the nanopore.\pause
    
    Tends to create errors on the homopolymer length...\pause
    
    DTW has been used by [Loose, M., Malla, S. Stout, 2016] and [R. Han, S. Wang, X. Gao, 2020] to try to counter this effect.
    %DTW already used to align the raw signal. We propose using it to aling called reads and provide a visualization of the impact of homopolymer extensions on ED and DTW.
    
\end{frame}

\begin{frame}{Theoretical motivation}
    $X$ and $Y$ strings, $N=|X|$ and $M=|Y|$.\\
    The dynamic programming takes $\Oh(N^2)$-time if $M=N$. Can we do better?\pause
    \begin{block}{No strongly subquadratic [Gold and Sharir]}
    %There are no strongly subquadratic algorithms to compute the DTW distance between two strings over a ternary alphabet unless the Strong Exponential Hypothesis (SETH) is false.
    $|\Sigma| \geq 3 \Rightarrow $ no $\Oh(N^{a})$ time algorithm with $a<2$ unless SETH is false.
    \end{block}\pause
    
    \ntheme{\large Run-length compressed}\\
    Let $n$ and $m$ be the number of runs in $X$ and $Y$. \pause
    \begin{itemize}
    \item General: $\Oh(mN+Mn)$-time [Froese et al.] \pause
    \item Binary: $\Oh(nm)$-time [Dupont and Marteau] \pause
    \end{itemize} \hfill
    
    \ntheme{\large Low distance regime}\\
    Kuszmaul showed how to compute the distance if it is $\leq k$ in $\Oh(kN)$-time.
    \end{frame}
    
    
    